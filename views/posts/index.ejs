<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì»¤ë®¤ë‹ˆí‹° | DSHì—ë“€</title>
  <meta name="description" content="DSHì—ë“€ íšŒì› ì»¤ë®¤ë‹ˆí‹° - ììœ ê²Œì‹œíŒ, ì •ë³´ê³µìœ , Q&A, ê³µì§€ì‚¬í•­ì„ í†µí•´ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ë‚˜ëˆ„ì„¸ìš”">
  <meta name="keywords" content="DSHì—ë“€, ì»¤ë®¤ë‹ˆí‹°, ììœ ê²Œì‹œíŒ, ì •ë³´ê³µìœ , Q&A, ê³µì§€ì‚¬í•­, êµìœ¡, ìº í”„">
  
  <!-- Open Graph ë©”íƒ€ íƒœê·¸ -->
  <meta property="og:title" content="ì»¤ë®¤ë‹ˆí‹° | DSHì—ë“€">
  <meta property="og:description" content="DSHì—ë“€ íšŒì› ì»¤ë®¤ë‹ˆí‹° - ììœ ê²Œì‹œíŒ, ì •ë³´ê³µìœ , Q&A, ê³µì§€ì‚¬í•­ì„ í†µí•´ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ë‚˜ëˆ„ì„¸ìš”">
  <meta property="og:type" content="website">
  <meta property="og:url" content="<%= req.protocol %>://<%= req.get('host') %>/posts">
  <meta property="og:site_name" content="DSHì—ë“€">
  <meta property="og:image" content="<%= req.protocol %>://<%= req.get('host') %>/images/logo.png">
  <meta property="og:locale" content="ko_KR">
  
  <!-- íŠ¸ìœ„í„° ì¹´ë“œ ë©”íƒ€ íƒœê·¸ -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ì»¤ë®¤ë‹ˆí‹° | DSHì—ë“€">
  <meta name="twitter:description" content="DSHì—ë“€ íšŒì› ì»¤ë®¤ë‹ˆí‹° - ììœ ê²Œì‹œíŒ, ì •ë³´ê³µìœ , Q&A, ê³µì§€ì‚¬í•­ì„ í†µí•´ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ë‚˜ëˆ„ì„¸ìš”">
  <meta name="twitter:image" content="<%= req.protocol %>://<%= req.get('host') %>/images/logo.png">
  
  <!-- ê¸°íƒ€ SEO ë©”íƒ€ íƒœê·¸ -->
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <link rel="canonical" href="<%= req.protocol %>://<%= req.get('host') %>/posts">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <!-- AOS Animation Library - ì§€ì—° ë¡œë”© -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" media="print" onload="this.media='all'">
  
  <!-- Google Fonts - ìµœì í™”ëœ ë¡œë”© -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css">
  
  <style>
    /* ì„¸ë ¨ëœ ì»¤ë®¤ë‹ˆí‹° í—¤ë” ìŠ¤íƒ€ì¼ */
    .hero-section {
      position: relative;
      min-height: 65vh;
      display: flex;
      align-items: center;
      overflow: hidden;
    }
    
    .hero-background {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 1;
    }
    
    .gradient-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #667eea 100%);
      z-index: 1;
    }
    
    .pattern-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 20% 80%, rgba(255,255,255,0.08) 0%, transparent 40%),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.04) 0%, transparent 40%);
      background-size: 200px 200px, 150px 150px;
      z-index: 2;
      will-change: auto;
    }
    
    .hero-content {
      z-index: 3;
    }
    
    /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
    .hero-badge-wrapper {
      display: flex;
      align-items: center;
    }
    
    .hero-badge {
      position: relative;
      display: inline-flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50px;
      padding: 0.8rem 1.5rem;
      color: white;
      font-weight: 500;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      will-change: transform;
    }
    
    .badge-icon {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.8rem;
      font-size: 0.9rem;
    }
    
    .badge-text {
      font-size: 0.95rem;
      letter-spacing: 0.5px;
    }
    
    .badge-glow {
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,215,0,0.1));
      border-radius: 50px;
      z-index: -1;
      opacity: 0.6;
    }
    
    /* íƒ€ì´í‹€ ìŠ¤íƒ€ì¼ */
    .hero-title {
      font-size: 3.8rem;
      font-weight: 700;
      line-height: 1.2;
      color: white;
      text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    .title-line-1 {
      display: block;
      margin-bottom: 0.5rem;
    }
    
    .title-line-2 {
      display: block;
    }
    
    .gradient-text {
      background: linear-gradient(45deg, #ffd700, #ffeb3b, #ffc107);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: none;
    }
    
    /* ì„¤ëª… í…ìŠ¤íŠ¸ */
    .hero-description {
      font-size: 1.25rem;
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
    
    /* í†µê³„ ì¹´ë“œë“¤ */
    .stats-container {
      display: flex;
      gap: 1.5rem;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 20px;
      padding: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15);
    }
    
    .stat-icon {
      background: rgba(255, 215, 0, 0.2);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffd700;
      font-size: 1.2rem;
    }
    
    .stat-content {
      flex: 1;
    }
    
    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: #ffd700;
      line-height: 1;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.8);
      margin-top: 0.25rem;
    }
    
    /* ì•¡ì…˜ ì¹´ë“œ */
    .action-wrapper {
      display: flex;
      justify-content: center;
    }
    
    .action-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 25px;
      padding: 2.5rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.3);
      text-align: center;
      max-width: 350px;
      width: 100%;
    }
    
    .welcome-section {
      margin-bottom: 2rem;
    }
    
    .crown-icon,
    .level-icon,
    .rocket-icon {
      background: linear-gradient(45deg, #667eea, #764ba2);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1rem;
      color: white;
      font-size: 1.5rem;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    }

    /* í™˜ì˜ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
    .welcome-header {
      margin-bottom: 1rem;
    }

    .welcome-content {
      text-align: center;
    }

    .welcome-title {
      margin: 0 0 0.5rem 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: #333;
    }

    .welcome-name-section {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }

    .user-name {
      font-size: 1rem;
      font-weight: 500;
      color: #555;
    }

    .user-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      max-width: fit-content;
    }

    .user-badge.admin-badge {
      background-color: #ffc107;
      color: #212529;
    }

    .user-badge.level-badge.level-1 {
      background-color: #6c757d;
      color: white;
    }

    .user-badge.level-badge.level-2 {
      background: linear-gradient(45deg, #c0c0c0, #e8e8e8);
      color: #333;
      border: 1px solid #b0b0b0;
    }

    .user-badge.level-badge.level-3 {
      background-color: #ffc107;
      color: #212529;
    }

    .user-badge.level-badge.level-4 {
      background: linear-gradient(45deg, #8e44ad, #9b59b6, #e74c3c);
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .user-badge.level-badge.level-5 {
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
      background-size: 300% 300%;
      animation: diamondShine 3s ease-in-out infinite;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    @keyframes diamondShine {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* ê²Œì‹œê¸€ ëª©ë¡ìš© ì‹¤ë²„ ìŠ¤íƒ€ì¼ */
    .level-2-silver {
      background: linear-gradient(45deg, #c0c0c0, #e8e8e8) !important;
      color: #333 !important;
      border: 1px solid #b0b0b0 !important;
    }

    /* ê²Œì‹œê¸€ ëª©ë¡ìš© í”Œë˜í‹°ë„˜ ìŠ¤íƒ€ì¼ */
    .level-4-platinum {
      background: linear-gradient(45deg, #8e44ad, #9b59b6, #e74c3c) !important;
      color: white !important;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important;
    }

    /* ê²Œì‹œê¸€ ëª©ë¡ìš© ë‹¤ì´ì•„ëª¬ë“œ ìŠ¤íƒ€ì¼ */
    .level-5-diamond {
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57) !important;
      background-size: 300% 300% !important;
      animation: diamondShine 3s ease-in-out infinite !important;
      color: white !important;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
    }
    
    .welcome-title {
      color: #333;
      font-weight: 600;
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
    }
    
    .welcome-name {
      color: #667eea;
      font-weight: 700;
      font-size: 1.1rem;
      margin: 0;
    }
    
    .welcome-desc {
      color: #666;
      font-size: 1rem;
      margin: 0;
    }
    
    /* ì•¡ì…˜ ë²„íŠ¼ */
    .action-btn {
      position: relative;
      display: inline-block;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      padding: 1rem 2rem;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      transition: box-shadow 0.2s ease;
      border: none;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.25);
      width: 100%;
      will-change: box-shadow;
    }
    
    .action-btn:hover {
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.35);
      color: white;
      text-decoration: none;
    }
    
    .btn-content {
      position: relative;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .btn-glow {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      border-radius: 50px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .action-btn:hover .btn-glow {
      opacity: 1;
    }
    
    /* ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 768px) {
      .hero-section {
        min-height: 100vh;
      }
      
      .hero-title {
        font-size: 2.8rem;
      }
      
      .hero-description {
        font-size: 1.1rem;
      }
      
      .stats-container {
        flex-direction: column;
        gap: 1rem;
      }
      
      .stat-card {
        padding: 1.2rem;
      }
      
      .stat-number {
        font-size: 1.6rem;
      }
      
      .action-card {
        padding: 2rem;
        margin-top: 2rem;
      }
    }
    
    @media (max-width: 576px) {
      .hero-title {
        font-size: 2.2rem;
      }
      
      .pattern-overlay {
        display: none;
      }
    }

    /* ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ ì „ìš© ìŠ¤íƒ€ì¼ */
    .post-row {
      transition: background-color 0.2s ease, border-left-color 0.2s ease, box-shadow 0.2s ease;
      border-left: 3px solid transparent;
      position: relative;
      background-color: white;
      will-change: background-color, border-left-color, box-shadow;
    }
    
    .post-row:hover {
      background-color: #f8f9fa !important;
      border-left-color: #667eea;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      z-index: 1;
    }
    
    .table-hover > tbody > tr:hover > td {
      background-color: #f8f9fa !important;
    }
    
    .stretched-link::after {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      z-index: 1;
      content: "";
    }
    
    .badge.rounded-pill {
      font-size: 0.7rem;
      padding: 0.3rem 0.6rem;
    }
    
    .table th {
      font-weight: 600;
      font-size: 0.9rem;
      color: #495057;
      padding: 1rem 0.75rem;
    }
    
    .table td {
      vertical-align: middle;
      border-color: #f1f3f4;
      border-bottom: 1px solid #f1f3f4;
      padding: 1rem 0.75rem;
    }
    
    .table tbody tr {
      border-bottom: 1px solid #f1f3f4;
    }
    
    .table tbody tr:last-child {
      border-bottom: none;
    }
    
    .dropdown-toggle::after {
      display: none;
    }
    
    @media (max-width: 768px) {
      .table-responsive table,
      .table-responsive thead,
      .table-responsive tbody,
      .table-responsive th,
      .table-responsive td,
      .table-responsive tr {
        display: block;
      }
      
      .table-responsive thead tr {
        position: absolute;
        top: -9999px;
        left: -9999px;
      }
      
      .table-responsive tr {
        border: 1px solid #ccc;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 8px;
        background: white;
      }
      
      .table-responsive td {
        border: none;
        padding: 0.5rem;
        position: relative;
        padding-left: 30%;
      }
      
      .table-responsive td:before {
        content: attr(data-label);
        position: absolute;
        left: 6px;
        width: 25%;
        padding-right: 10px;
        white-space: nowrap;
        font-weight: bold;
        color: #333;
      }
    }
    

  </style>
</head>
<body>

<%- include('../partials/header') %>

<!-- ì„¸ë ¨ëœ ì»¤ë®¤ë‹ˆí‹° í—¤ë” -->
<div class="hero-section">
  <div class="hero-background">
    <div class="gradient-overlay"></div>
    <div class="pattern-overlay"></div>
  </div>
  
  <div class="container position-relative hero-content">
    <div class="row align-items-center py-5">
      <div class="col-lg-8">
        <div class="content-wrapper">
          <!-- ìƒë‹¨ ë°°ì§€ -->
          <div class="hero-badge-wrapper mb-4">
            <div class="hero-badge">
              <div class="badge-icon">
                <i class="fas fa-users"></i>
              </div>
              <span class="badge-text">Community Space</span>
              <div class="badge-glow"></div>
            </div>
          </div>
          
          <!-- ë©”ì¸ íƒ€ì´í‹€ -->
          <h1 class="hero-title mb-4">
            <span class="title-line-1">í•¨ê»˜ ë§Œë“¤ì–´ê°€ëŠ”</span>
            <span class="title-line-2">
              <span class="gradient-text">ì»¤ë®¤ë‹ˆí‹°</span>
            </span>
          </h1>
          
          <!-- ì„¤ëª… í…ìŠ¤íŠ¸ -->
          <p class="hero-description mb-5">
            DSHì—ë“€ íšŒì›ë“¤ê³¼ í•¨ê»˜ ì§€ì‹ì„ ë‚˜ëˆ„ê³ , ê²½í—˜ì„ ê³µìœ í•˜ë©°, 
            <br class="d-none d-md-block">ì„œë¡œ ì„±ì¥í•´ë‚˜ê°€ëŠ” ì†Œí†µì˜ ê³µê°„ì…ë‹ˆë‹¤
          </p>
          
          <!-- í†µê³„ ì¹´ë“œë“¤ -->
          <div class="stats-container">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-file-alt"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number">
                  <% if (posts && posts.length > 0) { %>
                    <%= posts.length %>
                  <% } else { %>
                    0
                  <% } %>
                </div>
                <div class="stat-label">ê²Œì‹œê¸€</div>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fas fa-eye"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number">
                  <% if (posts && posts.length > 0) { %>
                    <%= posts.reduce((sum, post) => sum + (post.views || 0), 0) %>
                  <% } else { %>
                    0
                  <% } %>
                </div>
                <div class="stat-label">ì¡°íšŒìˆ˜</div>
              </div>
            </div>
            
                         <div class="stat-card">
               <div class="stat-icon">
                 <i class="fas fa-heart"></i>
               </div>
               <div class="stat-content">
                 <div class="stat-number">
                   <% if (posts && posts.length > 0) { %>
                     <%= posts.reduce((sum, post) => sum + (post.likes ? post.likes.length : 0), 0) %>
                   <% } else { %>
                     0
                   <% } %>
                 </div>
                 <div class="stat-label">ì¢‹ì•„ìš”</div>
               </div>
             </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="action-wrapper">
          <div class="action-card">
            <% if (user) { %>
              <div class="welcome-section mb-4">
                <div class="welcome-header">
                  <div class="welcome-content">
                    <h5 class="welcome-title">í™˜ì˜í•©ë‹ˆë‹¤!</h5>
                    <div class="welcome-name-section">
                      <span class="user-name"><%= user.name %>ë‹˜</span>
                      <% if (user.role === 'admin') { %>
                        <div class="user-badge admin-badge">
                          <i class="fas fa-crown"></i>
                          <span>ê´€ë¦¬ì</span>
                        </div>
                      <% } else if (user.communityLevel && user.communityLevel.level) { %>
                        <div class="user-badge level-badge level-<%= user.communityLevel.level %>">
                          <i class="<%= user.communityLevel.level === 1 ? 'fas fa-medal' : user.communityLevel.level === 2 ? 'fas fa-medal' : user.communityLevel.level === 3 ? 'fas fa-medal' : user.communityLevel.level === 4 ? 'fas fa-gem' : 'fas fa-crown' %>"></i>
                          <span><%= user.communityLevel.title %></span>
                        </div>
                      <% } %>
                    </div>
                  </div>
                </div>
              </div>
              
              <a href="/posts/create" class="action-btn primary-btn">
                <div class="btn-content">
                  <i class="fas fa-pen-fancy me-2"></i>
                  <span>ìƒˆ ê¸€ ì‘ì„±í•˜ê¸°</span>
                </div>
                <div class="btn-glow"></div>
              </a>
            <% } else { %>
              <div class="welcome-section mb-4">
                <div class="rocket-icon">
                  <i class="fas fa-rocket"></i>
                </div>
                <h5 class="welcome-title">ì§€ê¸ˆ ì‹œì‘í•˜ì„¸ìš”!</h5>
                <p class="welcome-desc">ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•´ë³´ì„¸ìš”</p>
              </div>
              
              <a href="/login" class="action-btn primary-btn">
                <div class="btn-content">
                  <i class="fas fa-sign-in-alt me-2"></i>
                  <span>ë¡œê·¸ì¸í•˜ì—¬ ì°¸ì—¬í•˜ê¸°</span>
                </div>
                <div class="btn-glow"></div>
              </a>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container my-5">


  <!-- ê²€ìƒ‰ ë° í•„í„° ì„¹ì…˜ -->
  <div class="row mb-4">
    <div class="col-lg-8">
      <div class="d-flex flex-wrap gap-2 mb-3" id="categoryButtons">
        <button data-category="all" class="btn <%= category === 'all' ? 'btn-primary' : 'btn-outline-primary' %> btn-sm category-btn">
          <i class="fas fa-th-large me-1"></i>ì „ì²´
        </button>
        <button data-category="general" class="btn <%= category === 'general' ? 'btn-primary' : 'btn-outline-primary' %> btn-sm category-btn">
          <i class="fas fa-comments me-1"></i>ììœ ê²Œì‹œíŒ
        </button>
        <button data-category="info" class="btn <%= category === 'info' ? 'btn-primary' : 'btn-outline-primary' %> btn-sm category-btn">
          <i class="fas fa-info-circle me-1"></i>ì •ë³´ ê³µìœ 
        </button>
        <button data-category="notice" class="btn <%= category === 'notice' ? 'btn-primary' : 'btn-outline-primary' %> btn-sm category-btn">
          <i class="fas fa-bullhorn me-1"></i>ê³µì§€ì‚¬í•­
        </button>
        <button data-category="qna" class="btn <%= category === 'qna' ? 'btn-primary' : 'btn-outline-primary' %> btn-sm category-btn">
          <i class="fas fa-question-circle me-1"></i>Q&A
        </button>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="d-flex gap-2">
        <form class="d-flex flex-grow-1" id="searchForm">
          <input type="hidden" id="searchCategory" value="<%= category %>">
          <input type="text" id="searchInput" class="form-control form-control-sm" placeholder="ì œëª©, ë‚´ìš©, íƒœê·¸ ê²€ìƒ‰..." value="<%= search %>">
          <button type="submit" class="btn btn-outline-primary btn-sm ms-2" id="searchBtn">
            <i class="fas fa-search"></i>
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- ê²Œì‹œê¸€ ëª©ë¡ -->
  <div class="row">

    
    <% if (posts && posts.length > 0) { %>
      <!-- ê¹”ë”í•œ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ê²Œì‹œíŒ -->
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="table-responsive">
            <table class="table mb-0" style="border-spacing: 0; border-collapse: separate;">
              <thead class="bg-light">
                <tr>
                  <th class="border-0 ps-4" style="width: 45%;">ì œëª©</th>
                  <th class="border-0 text-center" style="width: 15%;">ì‘ì„±ì</th>
                  <th class="border-0 text-center" style="width: 8%;">ëŒ“ê¸€</th>
                  <th class="border-0 text-center" style="width: 8%;">ì¡°íšŒ</th>
                  <th class="border-0 text-center" style="width: 9%;">ì¢‹ì•„ìš”</th>
                  <th class="border-0 text-center" style="width: 15%;">ì‘ì„±ì¼</th>
                </tr>
              </thead>
                             <tbody id="postsContainer">
                <% posts.forEach(post => { %>
                  <tr class="post-row" style="cursor: pointer;"
                      data-category="<%= post.category %>"
                      data-title="<%= post.title %>"
                      data-author="<%= post.author ? post.author.name : 'ì•Œ ìˆ˜ ì—†ìŒ' %>"
                      data-comments="<%= post.commentCount || 0 %>"
                      data-views="<%= post.views || 0 %>"
                      data-date="<%= new Date(post.createdAt).toLocaleDateString('ko-KR') %>">
                    <td class="ps-4 py-3">
                      <div class="d-flex align-items-start">
                        <div class="flex-grow-1">
                          <!-- ì¹´í…Œê³ ë¦¬ ë°°ì§€ -->
                          <span class="badge rounded-pill me-5 
                            <%= post.category === 'notice' ? 'bg-danger' : 
                                post.category === 'info' ? 'bg-success text-white' :
                                post.category === 'qna' ? 'bg-info text-white' : 'bg-secondary' %>">
                            <%= post.category === 'general' ? 'ììœ ' :
                                post.category === 'info' ? 'ì •ë³´ ê³µìœ ' :
                                post.category === 'notice' ? 'ê³µì§€' :
                                post.category === 'qna' ? 'Q&A' : post.category %>
                          </span>
                          
                          <!-- ì œëª© -->
                          <h6 class="mb-1 fw-semibold">
                            <a href="/posts/<%= post._id %>" class="text-decoration-none text-dark stretched-link">
                              <%= post.title %>
                            </a>
                            <% if (post.category === 'notice') { %>
                              <i class="fas fa-thumbtack text-danger ms-1" title="ê³µì§€ì‚¬í•­"></i>
                            <% } %>
                            <% if (post.isPrivate) { %>
                              <i class="fas fa-lock text-warning ms-1" title="ë¹„ë°€ê¸€"></i>
                            <% } %>
                          </h6>
                          
                          <!-- ë¯¸ë¦¬ë³´ê¸° -->
                          <p class="text-muted small mb-1" style="line-height: 1.4;">
                            <%= typeof post.getExcerpt === 'function' ? post.getExcerpt(80) : post.content.substring(0, 80) + '...' %>
                          </p>
                          
                          <!-- íƒœê·¸ -->
                          <% if (post.tags && post.tags.length > 0) { %>
                            <div class="mt-1">
                              <% post.tags.slice(0, 3).forEach(tag => { %>
                                <span class="badge bg-light text-secondary" style="font-size: 0.7rem; margin-right: 0.1rem;">#<%= tag %></span>
                              <% }) %>
                            </div>
                          <% } %>
                        </div>
                        
                        <!-- ê´€ë¦¬ì ë©”ë‰´ -->
                        <% if (user && (user.role === 'admin' || (post.author && post.author._id && post.author._id.toString() === user._id.toString()))) { %>
                          <div class="dropdown" onclick="event.stopPropagation(); event.preventDefault();" style="position: relative; z-index: 999;">
                            <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" 
                                    data-bs-toggle="dropdown" onclick="event.stopPropagation(); event.preventDefault();">
                              <i class="fas fa-ellipsis-v"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" style="z-index: 1000;">
                              <li><a class="dropdown-item" href="/posts/<%= post._id %>/edit" onclick="event.stopPropagation();">
                                <i class="fas fa-edit me-2"></i>ìˆ˜ì •
                              </a></li>
                              <li><a class="dropdown-item text-danger" href="#" 
                                     onclick="event.stopPropagation(); deletePost('<%= post._id %>')">
                                <i class="fas fa-trash me-2"></i>ì‚­ì œ
                              </a></li>
                            </ul>
                          </div>
                        <% } %>
                      </div>
                    </td>
                    
                    <!-- ì‘ì„±ì -->
                    <td class="text-center py-3">
                      <div class="d-flex flex-column align-items-center">
                        <% if (post.author && post.author.profilePhoto) { %>
                          <img src="<%= post.author.profilePhoto %>" alt="í”„ë¡œí•„ ì‚¬ì§„" 
                               class="rounded-circle mb-1" style="width: 32px; height: 32px; object-fit: cover;">
                        <% } else { %>
                          <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center mb-1" 
                               style="width: 32px; height: 32px; font-size: 0.8rem;">
                            <%= post.author ? post.author.name.charAt(0).toUpperCase() : 'ì•Œ' %>
                          </div>
                        <% } %>
                        <div>
                          <small class="text-muted">
                            <%= post.author ? post.author.name : 'ì•Œ ìˆ˜ ì—†ìŒ' %>
                          </small>
                          <% if (post.author && post.author.role === 'admin') { %>
                            <div class="mt-1">
                              <span class="badge bg-warning text-dark" style="font-size: 0.6rem;">
                                <i class="fas fa-crown me-1"></i>ê´€ë¦¬ì
                              </span>
                            </div>
                          <% } else if (post.author && post.author.communityLevel && post.author.communityLevel.level) { %>
                            <div class="mt-1">
                              <span class="badge <%= post.author.communityLevel.level === 1 ? 'bg-secondary' : post.author.communityLevel.level === 2 ? 'level-2-silver' : post.author.communityLevel.level === 3 ? 'bg-warning text-dark' : post.author.communityLevel.level === 4 ? 'level-4-platinum' : 'level-5-diamond' %>" style="font-size: 0.6rem;">
                                <i class="<%= post.author.communityLevel.level === 1 ? 'fas fa-medal' : post.author.communityLevel.level === 2 ? 'fas fa-medal' : post.author.communityLevel.level === 3 ? 'fas fa-medal' : post.author.communityLevel.level === 4 ? 'fas fa-gem' : 'fas fa-crown' %> me-1"></i>
                                <%= post.author.communityLevel.title %>
                              </span>
                            </div>
                          <% } %>
                        </div>
                      </div>
                    </td>
                    
                    <!-- ëŒ“ê¸€ ìˆ˜ -->
                    <td class="text-center py-3">
                      <span class="text-primary fw-semibold">
                        <i class="fas fa-comment me-1"></i>
                        <%= post.commentCount || 0 %>
                      </span>
                    </td>
                    
                    <!-- ì¡°íšŒìˆ˜ -->
                    <td class="text-center py-3">
                      <span class="text-muted">
                        <i class="fas fa-eye me-1"></i>
                        <%= post.views || 0 %>
                      </span>
                    </td>
                    
                    <!-- ì¢‹ì•„ìš” -->
                    <td class="text-center py-3">
                      <button class="btn btn-sm btn-outline-danger like-btn" 
                              onclick="toggleLike('<%= post._id %>', this)" 
                              data-post-id="<%= post._id %>"
                              style="border: none; background: none;">
                        <i class="fas fa-heart me-1 <%= user && post.isLiked ? 'text-danger' : 'text-muted' %>"></i>
                        <span class="like-count"><%= post.likes ? post.likes.length : 0 %></span>
                      </button>
                    </td>
                    
                    <!-- ì‘ì„±ì¼ -->
                    <td class="text-center py-3">
                      <small class="text-muted">
                        <%= new Date(post.createdAt).toLocaleDateString('ko-KR', { 
                          month: 'short', 
                          day: 'numeric',
                          year: new Date(post.createdAt).getFullYear() !== new Date().getFullYear() ? 'numeric' : undefined
                        }) %>
                      </small>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    <% } else { %>
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center py-5">
            <div class="mb-4">
              <i class="fas fa-pen-fancy fa-4x text-primary opacity-50"></i>
            </div>
            <h3 class="text-dark mb-3">ì•„ì§ ì‘ì„±ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</h3>
            <p class="text-muted mb-4">
              ì»¤ë®¤ë‹ˆí‹°ì˜ ì²« ë²ˆì§¸ ê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”!<br>
              ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ê²½í—˜ê³¼ ì´ì•¼ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.
            </p>
            <% if (user) { %>
              <a href="/posts/create" class="btn btn-primary btn-lg me-3">
                <i class="fas fa-plus me-2"></i>ì²« ê¸€ ì‘ì„±í•˜ê¸°
              </a>
              <a href="/posts?category=notice" class="btn btn-outline-primary btn-lg">
                <i class="fas fa-bullhorn me-2"></i>ê³µì§€ì‚¬í•­ ë³´ê¸°
              </a>
            <% } else { %>
              <a href="/login" class="btn btn-primary btn-lg">
                <i class="fas fa-sign-in-alt me-2"></i>ë¡œê·¸ì¸í•˜ì—¬ ì°¸ì—¬í•˜ê¸°
              </a>
            <% } %>
          </div>
        </div>
      </div>
    <% } %>
  </div>

  <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
  <% if (pagination && pagination.totalPages > 1) { %>
    <nav aria-label="í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜" class="mt-5">
      <ul class="pagination justify-content-center">
        <% if (pagination.hasPrevPage) { %>
          <li class="page-item">
            <a class="page-link" href="/posts?page=<%= pagination.currentPage - 1 %>&category=<%= category %>&search=<%= search %>">
              <i class="fas fa-chevron-left"></i> ì´ì „
            </a>
          </li>
        <% } %>

        <% for (let i = Math.max(1, pagination.currentPage - 2); i <= Math.min(pagination.totalPages, pagination.currentPage + 2); i++) { %>
          <li class="page-item <%= i === pagination.currentPage ? 'active' : '' %>">
            <a class="page-link" href="/posts?page=<%= i %>&category=<%= category %>&search=<%= search %>">
              <%= i %>
            </a>
          </li>
        <% } %>

        <% if (pagination.hasNextPage) { %>
          <li class="page-item">
            <a class="page-link" href="/posts?page=<%= pagination.currentPage + 1 %>&category=<%= category %>&search=<%= search %>">
              ë‹¤ìŒ <i class="fas fa-chevron-right"></i>
            </a>
          </li>
        <% } %>
      </ul>
    </nav>
  <% } %>
</div>

<style>
  .hover-card {
    transition: all 0.3s ease;
  }
  
  .hover-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1) !important;
  }
  
  .badge {
    font-size: 0.75em;
  }

  /* AJAXë¡œ ë™ì  ìƒì„±ë˜ëŠ” ë“±ê¸‰ë³„ ë°°ì§€ ìŠ¤íƒ€ì¼ */
  .level-2-silver {
    background: linear-gradient(45deg, #c0c0c0, #e8e8e8) !important;
    color: #333 !important;
    border: 1px solid #b0b0b0 !important;
  }

  .level-4-platinum {
    background: linear-gradient(45deg, #8e44ad, #9b59b6, #e74c3c) !important;
    color: white !important;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important;
  }

  .level-5-diamond {
    background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57) !important;
    background-size: 300% 300% !important;
    animation: diamondShine 3s ease-in-out infinite !important;
    color: white !important;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
  }

  @keyframes diamondShine {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
</style>

<script>
// ê²Œì‹œê¸€ ì‚­ì œ í•¨ìˆ˜ (ì „ì—­ ìŠ¤ì½”í”„)
function deletePost(postId) {
  if (confirm('ì •ë§ë¡œ ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    fetch(`/posts/${postId}/delete`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      }
    })
    .then(response => {
      if (response.ok) {
        location.reload();
      } else {
        alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
  }
}

document.addEventListener('DOMContentLoaded', function() {

function toggleLike(postId, button) {
  event.stopPropagation();
  
  // ë¡œê·¸ì¸ ì²´í¬
  const isLoggedIn = <%= user ? 'true' : 'false' %>;
  if (!isLoggedIn) {
    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    return;
  }
  
  fetch(`/posts/${postId}/like`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.liked !== undefined) {
      const icon = button.querySelector('i');
      const count = button.querySelector('.like-count');
      
      if (data.liked) {
        icon.classList.remove('text-muted');
        icon.classList.add('text-danger');
      } else {
        icon.classList.remove('text-danger');
        icon.classList.add('text-muted');
      }
      
      count.textContent = data.likesCount;
    } else {
      alert('ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  })
  .catch(error => {
    console.error('Error:', error);
    alert('ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  });
}

function stopEventPropagation(event) {
  event.stopPropagation();
  event.preventDefault();
}
}); // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¢…ë£Œ
</script>

<%- include('../partials/footer') %>

<!-- Bootstrap JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- AOS Animation Library - ì§€ì—° ë¡œë”© -->
<script>
// AOS ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§€ì—° ë¡œë”©
function loadAOS() {
  const script = document.createElement('script');
  script.src = 'https://unpkg.com/aos@2.3.1/dist/aos.js';
  script.onload = function() {
    AOS.init({
      duration: 600,
      once: true,
      offset: 50
    });
  };
  document.head.appendChild(script);
}

document.addEventListener('DOMContentLoaded', function() {
  // í˜ì´ì§€ ë¡œë“œ í›„ AOS ì´ˆê¸°í™”
  setTimeout(loadAOS, 100);

  // í˜„ì¬ ì¹´í…Œê³ ë¦¬ ìƒíƒœ ì¶”ì 
  let currentCategory = '<%= category %>';

  // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
  document.querySelectorAll('.category-btn').forEach(button => {
    button.addEventListener('click', function() {
      const category = this.getAttribute('data-category');
      
      // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      updateCategoryButtons(category);
      
      // ê²€ìƒ‰ì–´ ìœ ì§€í•˜ë©´ì„œ ì¹´í…Œê³ ë¦¬ í•„í„° ì ìš©
      const searchValue = document.getElementById('searchInput').value.trim();
      loadPosts(category, searchValue);
    });
  });

  // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
  function updateCategoryButtons(activeCategory) {
    currentCategory = activeCategory;
    document.getElementById('searchCategory').value = activeCategory;
    
    document.querySelectorAll('.category-btn').forEach(btn => {
      const category = btn.getAttribute('data-category');
      if (category === activeCategory) {
        btn.classList.remove('btn-outline-primary');
        btn.classList.add('btn-primary');
      } else {
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-outline-primary');
      }
    });
  }

  // ê²Œì‹œê¸€ ë¡œë“œ í•¨ìˆ˜
  function loadPosts(category, search) {
    const searchBtn = document.getElementById('searchBtn');
    
    // ë¡œë”© ìƒíƒœ í‘œì‹œ
    searchBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
    searchBtn.disabled = true;
    
    // AJAX ìš”ì²­
    const params = new URLSearchParams();
    if (category && category !== 'all') {
      params.append('category', category);
    }
    if (search) {
      params.append('search', search);
    }
    
    fetch(`/posts?${params.toString()}`, {
      headers: {
        'Accept': 'application/json'
      }
    })
    .then(response => response.json())
    .then(data => {
      // ê²€ìƒ‰ ê²°ê³¼ë¡œ ê²Œì‹œê¸€ ëª©ë¡ ì—…ë°ì´íŠ¸
      updatePostsList(data.posts);
      
      // URL ì—…ë°ì´íŠ¸ (ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ì§€ì›)
      const newUrl = `/posts?${params.toString()}`;
      window.history.pushState({}, '', newUrl);
    })
    .catch(error => {
      console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
      alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    })
    .finally(() => {
      // ë¡œë”© ìƒíƒœ í•´ì œ
      searchBtn.innerHTML = '<i class="fas fa-search"></i>';
      searchBtn.disabled = false;
    });
  }

  // AJAX ê²€ìƒ‰ ê¸°ëŠ¥
  document.getElementById('searchForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const searchValue = document.getElementById('searchInput').value.trim();
    loadPosts(currentCategory, searchValue);
  });

  // ê²Œì‹œê¸€ ëª©ë¡ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
  function updatePostsList(posts) {
    const postsContainer = document.getElementById('postsContainer');
    
    // postsContainerê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ ë°©ì§€
    if (!postsContainer) {
      console.error('postsContainer ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }
    
    // postsê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ ë°©ì§€
    if (!posts) {
      console.error('posts ë°ì´í„°ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      return;
    }
    
    if (!posts || posts.length === 0) {
      postsContainer.innerHTML = `
        <tr>
          <td colspan="6" class="text-center py-5 text-muted">
            <i class="fas fa-search fa-2x mb-3"></i>
            <p class="mb-0">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
          </td>
        </tr>
      `;
      return;
    }
    
    let html = '';
    posts.forEach(post => {
      const categoryBadge = getCategoryBadge(post.category);
      const categoryText = getCategoryText(post.category);
      const createdDate = new Date(post.createdAt).toLocaleDateString('ko-KR');
      
      html += `
        <tr class="post-row" style="cursor: pointer;"
            data-category="${post.category}"
            data-title="${post.title}"
            data-author="${post.author ? post.author.name : 'ì‚­ì œëœ ì‚¬ìš©ì'}"
            data-comments="${post.commentCount || 0}"
            data-views="${post.views || 0}"
            data-date="${createdDate}">
          <td class="ps-4 py-3">
            <div class="d-flex align-items-start">
              <div class="flex-grow-1">
                <span class="badge rounded-pill me-5 ${categoryBadge}">
                  ${categoryText}
                </span>
                <h6 class="mb-1 fw-semibold">
                  <a href="/posts/${post._id}" class="text-decoration-none text-dark stretched-link">
                    ${post.title}
                  </a>
                  ${post.category === 'notice' ? '<i class="fas fa-thumbtack text-danger ms-1" title="ê³µì§€ì‚¬í•­"></i>' : ''}
                  ${post.isPrivate ? '<i class="fas fa-lock text-warning ms-1" title="ë¹„ë°€ê¸€"></i>' : ''}
                </h6>
                                 ${post.tags && post.tags.length > 0 ? `
                   <div class="mt-1">
                     ${post.tags.slice(0, 3).map(tag => `<span class="badge bg-light text-secondary" style="font-size: 0.7rem; margin-right: 0.1rem;">#${tag}</span>`).join('')}
                   </div>
                 ` : ''}
              </div>
            </div>
          </td>
            <td class="text-center py-3">
              <div class="d-flex flex-column align-items-center">
                ${post.author && post.author.profilePhoto ? `
                  <img src="${post.author.profilePhoto}" alt="í”„ë¡œí•„ ì‚¬ì§„" 
                       class="rounded-circle mb-1" style="width: 32px; height: 32px; object-fit: cover;">
                ` : `
                  <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center mb-1" 
                       style="width: 32px; height: 32px; font-size: 0.8rem;">
                    ${post.author && post.author.name ? post.author.name.charAt(0).toUpperCase() : 'ì‚­'}
                  </div>
                `}
                <div>
                  <small class="text-muted">
                    ${post.author && post.author.name ? post.author.name : 'ì‚­ì œëœ ì‚¬ìš©ì'}
                  </small>
                ${post.author && post.author.role === 'admin' ? `
                  <div class="mt-1">
                    <span class="badge bg-warning text-dark" style="font-size: 0.6rem;">
                      <i class="fas fa-crown me-1"></i>ê´€ë¦¬ì
                    </span>
                  </div>
                ` : post.author && post.author.communityLevel && post.author.communityLevel.level ? `
                  <div class="mt-1">
                    <span class="badge ${getLevelBadgeClass(post.author.communityLevel.level)}" style="font-size: 0.6rem;">
                      <i class="${getLevelIcon(post.author.communityLevel.level)} me-1"></i>
                      ${post.author.communityLevel.title}
                    </span>
                  </div>
                ` : ''}
              </div>
            </div>
          </td>
          <td class="text-center py-3">
            <small class="text-muted">${post.commentCount || 0}</small>
          </td>
          <td class="text-center py-3">
            <small class="text-muted">${post.views || 0}</small>
          </td>
          <td class="text-center py-3">
            <small class="text-muted">${post.likes ? post.likes.length : 0}</small>
          </td>
          <td class="text-center py-3">
            <small class="text-muted">${createdDate}</small>
          </td>
        </tr>
      `;
    });
    
    postsContainer.innerHTML = html;
  }

  // ì¹´í…Œê³ ë¦¬ ë°°ì§€ í´ë˜ìŠ¤ ë°˜í™˜
  function getCategoryBadge(category) {
    switch(category) {
      case 'notice': return 'bg-danger';
      case 'info': return 'bg-success text-white';
      case 'qna': return 'bg-info text-white';
      default: return 'bg-secondary';
    }
  }

  // ì¹´í…Œê³ ë¦¬ í…ìŠ¤íŠ¸ ë°˜í™˜
  function getCategoryText(category) {
    switch(category) {
      case 'general': return 'ììœ ';
      case 'info': return 'ì •ë³´ ê³µìœ ';
      case 'notice': return 'ê³µì§€';
      case 'qna': return 'Q&A';
      default: return category;
    }
  }

  // ë“±ê¸‰ë³„ ë°°ì§€ í´ë˜ìŠ¤ ë°˜í™˜
  function getLevelBadgeClass(level) {
    switch(level) {
      case 1: return 'bg-secondary';      // ë¸Œë¡ ì¦ˆ - íšŒìƒ‰
      case 2: return 'level-2-silver';    // ì‹¤ë²„ - ê·¸ë¼ë°ì´ì…˜ íšŒìƒ‰
      case 3: return 'bg-warning text-dark'; // ê³¨ë“œ - ë…¸ë€ìƒ‰
      case 4: return 'level-4-platinum';  // í”Œë˜í‹°ë„˜ - ë³´ë¼ìƒ‰ ê·¸ë¼ë°ì´ì…˜
      case 5: return 'level-5-diamond';   // ë‹¤ì´ì•„ëª¬ë“œ - ë¬´ì§€ê°œ ê·¸ë¼ë°ì´ì…˜
      default: return 'bg-secondary';
    }
  }

  // ë“±ê¸‰ë³„ ì•„ì´ì½˜ ë°˜í™˜
  function getLevelIcon(level) {
    switch(level) {
      case 1: return 'fas fa-medal';      // ë¸Œë¡ ì¦ˆ - ë©”ë‹¬
      case 2: return 'fas fa-medal';      // ì‹¤ë²„ - ë©”ë‹¬
      case 3: return 'fas fa-medal';      // ê³¨ë“œ - ë©”ë‹¬
      case 4: return 'fas fa-gem';        // í”Œë˜í‹°ë„˜ - ë³´ì„
      case 5: return 'fas fa-crown';      // ë‹¤ì´ì•„ëª¬ë“œ - ì™•ê´€
      default: return 'fas fa-medal';
    }
  }

  // ê²Œì‹œê¸€ í–‰ í´ë¦­ ì´ë²¤íŠ¸ (ì¤‘ë³µ ë°©ì§€)
  document.addEventListener('click', function(e) {
    const postRow = e.target.closest('.post-row');
    if (postRow) {
      // ë§í¬ë‚˜ ë²„íŠ¼ í´ë¦­ ì‹œì—ëŠ” í–‰ í´ë¦­ ì´ë²¤íŠ¸ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
      if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || e.target.closest('a') || e.target.closest('button') || e.target.closest('.dropdown')) {
        return;
      }
      
      // ê²Œì‹œê¸€ ID ì¶”ì¶œ
      const postId = postRow.querySelector('a[href*="/posts/"]')?.href?.match(/\/posts\/([^\/]+)/)?.[1];
      if (postId) {
        console.log('ğŸ“– ê²Œì‹œê¸€ í´ë¦­:', postId);
        window.location.href = `/posts/${postId}`;
      }
    }
  });

  // Enter í‚¤ë¡œë„ ê²€ìƒ‰ ê°€ëŠ¥
  document.getElementById('searchInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('searchForm').dispatchEvent(new Event('submit'));
    }
  });
}); // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¢…ë£Œ
</script>

</body>
</html> 